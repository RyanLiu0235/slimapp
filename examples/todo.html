<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>slimapp</title>
  <script src="../dist/slim.js"></script>
</head>

<body>
  <div id="app"></div>
  <script type="text/javascript">
  var h = slim.h
  var app = slim.app

  var container = document.getElementById('app')
  var view = function(actions, state) {
    return h('div', {}, [
      h('h1', {}, ['todo']),
      h('p', {}, ['add todo:']),
      h('div', {}, [
        h('input', {
          id: 'input',
          type: 'text',
          placeholder: 'todo',
          keyup: function(e) {
            if (e.which === 13) {
              var todo = e.target.value.trim()
              if (todo) {
                console.log(actions.add)
                actions.add({
                  id: Date.now(),
                  text: todo
                })
              }
            }
          }
        })
      ]),
      h('hr'),
      h('ol', {},
        state.list.map(item => h('li', { key: item.id }, [
          item.text,
          h('button', {
            click: function() {
              actions.del(item.id)
            }
          }, ['x'])
        ]))
      )
    ])
  }
  var actions = {
    add: function(payload) {
      return function(state) {
        state.list.push(payload)
      }
    },
    del: function(id) {
      return function(state) {
        var index = state.list.findIndex(item => item.key === id)
        state.list.splice(index, 1)
      }
    }
  }
  var state = {
    list: [{
      id: Date.now(),
      text: 'this is a test'
    }]
  }

  app(view, actions, state, container)

  </script>
</body>

</html>
